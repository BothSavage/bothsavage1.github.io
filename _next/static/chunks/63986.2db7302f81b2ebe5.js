"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[63986],{63986:function(e,t,n){n.r(t);var s=n(85893),a=n(67294),r=n(11163),c=n(25675),i=n.n(c),o=n(66043);let WebmentionCount=e=>{let{target:t}=e,[n,r]=(0,a.useState)({count:0,type:{like:0,mention:0,reply:0,repost:0}}),fetchCounts=async e=>{let t=await fetch("https://webmention.io/api/count.json?target=".concat(encodeURIComponent(e)));return t.json?await t.json():t};return(0,a.useEffect)(()=>{(async function(){let e=await fetchCounts(t);r(e)})()},[t]),(0,s.jsx)("div",{className:"webmention-counts",children:n?(0,s.jsxs)("div",{className:"counts",children:[(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{className:"count",children:n.type.like||0}),"Likes"]}),(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{className:"count",children:n.type.reply||0}),"Replies"]}),(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{className:"count",children:(n.type.repost||0)+(n.type.mention||0)}),"Mentions"]})]}):(0,s.jsx)("p",{children:"Failed to fetch Webmention counts"})})},Avatar=e=>{let{author:t}=e;return(0,s.jsx)("a",{className:"avatar-wrapper",href:t.url,children:(0,s.jsx)(i(),{className:"avatar",src:t.photo,alt:t.name,fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"})},t.name)},WebmentionReplies=e=>{let{target:t}=e,[n,r]=(0,a.useState)([]),fetchMentions=async e=>fetch("https://webmention.io/api/mentions.jf2?per-page=500&target=".concat(encodeURIComponent(e),"&token=").concat((0,o.J)("COMMENT_WEBMENTION_TOKEN"))).then(e=>e.json?e.json():e);(0,a.useEffect)(()=>{!async function(){let e=await fetchMentions(t);e.children&&r(e.children)}()},[t]);let c=[...new Map(n.map(e=>[e.author.url,e])).values()].sort((e,t)=>new Date(e["wm-received"])-new Date(t["wm-received"])),i=n.filter(e=>"in-reply-to"in e&&"content"in e);return(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:c.length>0?"Already ".concat(c.length," people liked, shared or talked about this article:"):"Be the first one to share this article!"}),(0,s.jsx)("div",{className:"webmention-avatars",children:c.map(e=>(0,s.jsx)(Avatar,{author:e.author},e.author.name))}),i&&i.length?(0,s.jsxs)("div",{className:"webmention-replies",children:[(0,s.jsx)("h4",{children:"Replies"}),(0,s.jsx)("ul",{className:"replies",children:i.map(e=>(0,s.jsxs)("li",{className:"reply",children:[(0,s.jsx)("div",{children:(0,s.jsx)(Avatar,{author:e.author},e.author.name)}),(0,s.jsxs)("div",{className:"text",children:[(0,s.jsx)("p",{className:"reply-author-name",children:e.author.name}),(0,s.jsx)("p",{className:"reply-content",children:e.content.text})]})]},e.content.text))})]}):null]})};t.default=e=>{let{frontMatter:t}=e,n=(0,r.useRouter)(),a="https://".concat((0,o.J)("COMMENT_WEBMENTION_HOSTNAME")).concat(n.asPath),c="".concat(t.title," by @").concat((0,o.J)("COMMENT_WEBMENTION_TWITTER_USERNAME")," ").concat(a);return(0,s.jsxs)("div",{className:"webmention-block",children:[(0,s.jsxs)("h1",{className:"webmention-header",children:["powered by ",(0,s.jsx)("a",{href:"https://webmention.io",target:"_blank",rel:"noreferrer",children:"WebMention.io"})]}),(0,s.jsxs)("div",{className:"webmention-block-intro",children:["You can"," ",(0,s.jsx)("a",{target:"_blank",id:"tweet-post-url",href:"https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(c)),rel:"noopener noreferrer",children:"tweet this post"})," ","or"," ",(0,s.jsx)("a",{target:"_blank",id:"tweet-discuss-url",href:"https://www.twitter.com/search?q=".concat(a),rel:"noopener noreferrer",children:"discuss it on Twitter"}),", the comments will show up here."]}),(0,s.jsxs)("div",{className:"webmention-info",children:[(0,s.jsx)(WebmentionCount,{target:a}),(0,s.jsx)(WebmentionReplies,{target:a})]})]})}}}]);