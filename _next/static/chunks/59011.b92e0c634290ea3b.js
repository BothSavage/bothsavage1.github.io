"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[59011],{59011:function(t,e,o){o.r(e);var n=o(66043),u=o(54110),l=o(22006),c=o(11163),s=o(67294);e.default=t=>{let e=[],{theme:o}=(0,u.O)(),r=(0,c.useRouter)();(0,s.useEffect)(()=>{var e;(null==t?void 0:t.posts)&&(null==t?void 0:null===(e=t.posts)||void 0===e?void 0:e.length)>0&&fetchTwikooData(t.posts)},[r.events]),(0,s.useEffect)(()=>{updateCommentCount()},[o]);let a=(0,n.J)("COMMENT_TWIKOO_CDN_URL"),i=(0,n.J)("COMMENT_TWIKOO_ENV_ID"),fetchTwikooData=async t=>{t.forEach(t=>{t.slug=t.slug.startsWith("/")?t.slug:"/".concat(t.slug)});try{await (0,l.TY)(a,"js");let o=window.twikoo;o.getCommentsCount({envId:i,urls:null==t?void 0:t.map(t=>t.slug),includeReply:!0}).then(function(t){e=t,updateCommentCount()}).catch(function(t){console.error(t)})}catch(t){console.error("twikoo 加载失败",t)}},updateCommentCount=()=>{0!==e.length&&t.posts.forEach(t=>{let o=e.find(e=>e.url===t.slug);if(o){let e=document.querySelectorAll(".comment-count-text-".concat(t.id));e.forEach(t=>{t.innerHTML=o.count});let n=document.querySelectorAll(".comment-count-wrapper-".concat(t.id));n.forEach(t=>{t.classList.remove("hidden")})}})};return null}}}]);